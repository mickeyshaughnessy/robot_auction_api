<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RSX Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto&display=swap"
rel="stylesheet">
    <!-- Common Styles -->
    <link rel="stylesheet" href="styles.css">
    <!-- Dashboard Styles -->
    <link rel="stylesheet" href="dashboard.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>RSX Activity Dashboard</h1>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="api_docs.html">API Docs</a></li>
                    <li><a href="demo.html">Demo</a></li>
                    <li><a href="faq.html">FAQ</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <main>
        <div class="container">
            <div class="dashboard-grid">
                <div class="map-container">
                    <div id="map"></div>
                    <div class="map-controls">
                        <label><input type="checkbox" id="show-bids" checked> Show Bids</label>
                        <label><input type="checkbox" id="show-won-jobs" checked> Show Won Jobs</label>
                        <label><input type="checkbox" id="show-completed-jobs" checked> Show Completed
Jobs</label>
                    </div>
                </div>
                <div class="activity-feed">
                    <h2>Recent Activities</h2>
                    <pre id="activity-log"></pre>
                </div>
            </div>
            <div class="button-container">
                <button id="grab-job">Grab Job</button>
                <button id="submit-bid">Submit Bid</button>
            </div>
            <div id="submission-data"></div>
        </main>

    <!-- Add this script tag at the end of the file -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
integrity="sha256-/xUj+3OJU5yExlq6GSYGSHkIl+hWEEBJweTrofM1eSg=" crossorigin="anonymous"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            // Set the interval for making AJAX requests
            setInterval(makeNearbyRequest, 30000); // 30 seconds

            function makeNearbyRequest() {
                $.ajax({
                    url: '/nearby',
                    method: 'GET',
                    dataType: 'json',
                    success: function(data) {
                        // Update the map with the new nearby jobs
                        updateMap(data);
                    }
                });
            }

            // Function to update the map with new data
            function updateMap(nearbyJobs) {
                // Assuming you have a Leaflet map object named `map`
                var map = $('#map').data('leafletMap');

                // Clear any existing markers on the map
                map.clearMarkers();

                // Add new markers for each nearby job
                $.each(nearbyJobs, function(index, job) {
                    var marker = L.marker([job.latitude, job.longitude]).addTo(map);
                    marker.bindPopup(job.name + ' - ' + job.description);
                });
            }
        });
    </script>
</body>
</html>
